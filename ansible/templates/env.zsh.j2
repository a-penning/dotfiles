# env.zsh
# {{ ansible_managed }}
# Environment variables for ephemeral dotfiles session

export DOTFILES_ACTIVE=1
export DOTFILES_ROOT="{{ dotfiles_root }}"
export PATH="{{ dotfiles_bin }}:$PATH"

# Allow prompt substitution
setopt prompt_subst

# Disable any existing prompt
if command -v prompt >/dev/null 2>&1; then
  prompt off
fi

# Ensure RPROMPT is defined to avoid 'parameter not set' when nounset is enabled
export RPROMPT="${RPROMPT:-}"

# Dotfiles specific shell definitions
source "{{ dotfiles_shell }}/dotfiles.zsh"

# Common definitions (editor, history, and shell options)
source "{{ dotfiles_shell }}/definitions.zsh"

# Source other shell configuration files
source "{{ dotfiles_shell }}/overrides.zsh"
source "{{ dotfiles_shell }}/aliases.zsh"
source "{{ dotfiles_shell }}/functions.zsh"
source "{{ dotfiles_shell }}/prompt.zsh"
source "{{ dotfiles_shell }}/plugins.zsh"

# If custom.zsh exists, source it for user-specific customizations
if [ -f "{{ dotfiles_shell }}/custom.zsh" ]; then
  source "{{ dotfiles_shell }}/custom.zsh"
fi